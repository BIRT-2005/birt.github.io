<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script>
        function Generar() {
            // Borra todas las columnas y renglones de la tabla.
            document.getElementById("cuadrado").innerHTML = "";

            // Agregamos renglones y columnas.
            var tabla = document.getElementById("cuadrado");
            var lado = parseInt(document.getElementById("lado").value);
            var celda ="", nuevaFila="", r = 0, c=0;
            for (r = 0; r < lado; r++) {
                nuevaFila = tabla.insertRow(-1);
                celda = nuevaFila.insertCell(0);
                celda.innerHTML = "";
                celda.style.border = "none";
                for (c = 0; c < lado; c++) {
                    celda = nuevaFila.insertCell(-1);
                    var entrada = document.createElement("input");
                    entrada.setAttribute("type", "number");
                    entrada.setAttribute("value", Aleatorio());
                    entrada.setAttribute("required", "required");
                    // Asignamos los estilos al input.
                    entrada.setAttribute("style", "width:50px; color:blue; font-weight: bold;");
                    celda.appendChild(entrada);
                }
            }
            var celda = nuevaFila.insertCell(-1);
            celda.innerHTML = "suma";

            nuevaFila = tabla.insertRow(-1);
            for (c = 0; c < lado+2; c++) {
                celda = nuevaFila.insertCell(-1);
                celda.innerHTML = "suma";
            }
            tabla.rows[lado].cells[c-1].innerHTML="diagonal1";
            tabla.rows[lado].cells[0].innerHTML="diagonal2";
        }

        function Aleatorio() {
            return Math.floor(Math.random()*100);
        }

        function EjemploMagico() {
            var tabla = document.getElementById("cuadrado");
            for (r = 0; r < document.getElementById("lado").value; r++) {
                for (let c = 1; c <= document.getElementById("lado").value; c++) {
                    tabla.rows[r].cells[c].querySelector('input').value = document.getElementById("lado").value;
                }
            }
            document.getElementById("verificar").innerHTML = "Si es cuadrado magico";
            document.getElementById("verificar").style = "color: blue;";
        }

        function EjemploCuadrado() {
            var tabla = document.getElementById("cuadrado");
            var r = 0, c = 0;
            for (r = 0; r < document.getElementById("lado").value; r++) {
                for (c = 1; c <= document.getElementById("lado").value; c++) {
                    tabla.rows[r].cells[c].querySelector('input').value = Aleatorio();
                }
            }
            tabla.rows[r-1].cells[c-1].querySelector('input').value = -1;
            document.getElementById("verificar").innerHTML = "No es cuadrado magico";
            document.getElementById("verificar").style = "color: crimson;";
        }

        function Calcular() {
            var tabla = document.getElementById("cuadrado");
            var lado = tabla.rows.length;
            var r = 0, c=0, suma = 0;
            for (r = 0; r < lado-1; r++) {
                suma = 0;
                for (c = 1; c < lado; c++) {
                    suma += parseInt(tabla.rows[r].cells[c].querySelector('input').value);
                }
                tabla.rows[r].cells[lado].innerHTML = suma;
            }
        }
    </script>
</head>
<body onload="Generar()">
    <h1>CUADRADO MAGICO</h1>
    Los cuadrados mágicos, son un conjunto de números enteros diferentes colocados 
    en las casillas de un cuadrado y que se caracterizan porque la sumas de sus filas, 
    columnas y diagonales principales es siempre la misma, el valor de la suma es denominado Constante mágica del Cuadrado.
    <br>
    <p>SELECCIONE EL TAMAÑO DEL CUADRADO
    <select id="lado" onchange="Generar()">
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
    </select>
    <input type="button" value = "Generar" onclick="Generar()">
    <input type="button" value = "Calcular">
    <input type="button" value = "Ejemplo de Cuadrado Magico" onclick="EjemploMagico()">
    <input type="button" value = "Ejemplo de Cuadrado" onclick="EjemploCuadrado()">
    <table border="0.5" id="cuadrado" style="border-collapse: collapse"></table>
    <h1 id="verificar" style="color: crimson;">No es cuadrado magico</h1>
    </p>
</body>
</html>